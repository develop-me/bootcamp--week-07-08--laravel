# Day 3:

## Models
- Use `artisan tinker` to create a new model:
    ```bash
    $article = new Article();
    $article->title = "My amazing blog post";
    $article->article = "Today I went shopping. I bought some spoons.";
    $article->save();
    ```
- Look at `id` after save
- Show
    - `Article::all()`
    - `$article = Article::find(1);`
    - `$article->title;`
    - `$article->published = 0;`
    - `$article->save();`
- Make a change and look at `updated_at` property

## Exercise 01

## Demo

- Quick `Article::where()` demo: `Article::where('title', 'Blah')->orderBy('title')->get()`
- Comparisons `Article::where('updated_at', '>', '2020-03-01')->orderBy('created_at')->get()`

## Model methods

- Check out the Article model
- Creates Article model class, thus the uppercase "A"
- Explain why singular name used
- Talk about how methods are built in by extending Laravel's Model class with `class Article extends Model`
- we already have `save()`, `where()`, `all()` etc.
- define own method to show how old something is, e.g.
    ```php
    public function relativeDate()
    {
        return $this->created_at->diffForHumans();
    }
    ```

## Exercise 02

## Blade Dynamic Data: Feeding data into views

- draw diagram going from URL to route handling, controller, fetch data, pass into, view
- create new route
    ```php
    Route::get('/articles', function () {
        return view("articles/list", [
            "articles" => [
                ['title' => 'I wandered lonely...'],
                ['title' => 'Come who may'],
                ['title' => 'Summertime is here!'],
            ]
        ]);
    });
    ```

## Exercise 03

- new `articles/list` view with foreach:
    ```php
    @section("content")
        <div class="list-group">
            @foreach ($animals as $animal)
                <a href="" class="list-group-item list-group-item-action">
                    <div class="d-flex w-100 justify-content-between">
                        <h5 class="mb-1">{{ $animal['name'] }}</h5>
                    </div>
                </a>
            @endforeach
        </div>
    @endsection
    ```

## Exercise 04

## Controller
- Explain what controllers are
- Use `artisan` to make a controller
- Show the `Articles` controller
- Add `use App\Article` at top
- show `index()` method:
    ```php
    // shows all articles
    public function index()
    {
        return view("articles/list", [
            "articles" => Article::all()
        ]);
    }
    ```
- switch route to use it:
    ```php
    Route::get('/articles', "Articles@index");
    ```
- change template up:
    ```php
    <div class="list-group">
        @foreach ($articles as $article)
            <a href="" class="list-group-item list-group-item-action">
                <div class="d-flex w-100 justify-content-between">
                    <h5 class="mb-1">{{ $article->title }}</h5>
                </div>
            </a>
        @endforeach
    </div>

    ```

## Exercise 05

## Controller for `show()`
- update link for `<a href="/articles/{id}">`
- create template `show.blade.php`:
    ```php
    @extends("index")

    @section("title"){{
        $animal->name
    }}@endsection

    @section("content")
        <article class="card">
            <h2 class="card-header">
                {{ $animal->name }}
            </h2>

            <div class="card-body">
                <p class="card-text">{{ $animal->type }}</p>
            </div>
        </article>
    @endsection
    ```

- controller
    ```php
    // shows single article
    public function show($id)
    {
        $article = Article::find($id);

        return view("articles/show", [
            "article" => $article
        ]);
    }
    ```
- route:
    ```Route::get('/articles/{id}', "Articles@show");```

## Exercise 06

## Route Model Binding

- controller
    ```php
    // shows single article
    public function show(Article $article)
    {
        return view("articles/show", [
            "article" => $article
        ]);
    }
    ```
- route:
    `Route::get('/articles/{article}', "Articles@show");`

## Exercise 07

## Groups
- demo `Route::group(["prefix" => "articles"], function () { });`

## Exercise 08

## Search

- put search form in place
    ```html
    <form class="form-inline" action="/search" method="get">
        <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" name="query">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
    </form>
    ```
- create search route
- talk about Request
- show $request

$articles = Article::where("title", "like", "%{$query}%");

- 
```php
// shows search result
public function search(Request $request)
{
    $query = $request->get("query");

    $articles = Article::where("title", "like", "%{$query}%")
                        ->orWhere("content", "like", "%{$query}%")
                        ->get();

    return view("articles/search", [
        "query" => $query,
        "articles" => $articles,
    ]);
}
```