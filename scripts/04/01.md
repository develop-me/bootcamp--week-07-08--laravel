# Day 4

## Forms
- going to create a form to create animals (articles)
- new route:
    ```php
    Route::get('/animals/create', "Articles@create");
    ```
- new Controller method:
    ```php
    // shows create article form
    public function create()
    {
        return view("articles/form");
    }
    ```
- form structure:
    ```php
    <form method="post" class="form card">
        <h2 class="card-header">Create Article</h2>

        <fieldset class="card-body">
            @csrf

            <div class="form-group">
                <label for="title">Title</label>
                <input
                    id="title"
                    name="title"
                    class="form-control"
                    value=""
                />
            </div>

            <!--more fields here-->

        </fieldset>

        <div class="card-footer text-right">
            <button class="btn btn-success">Create Article</button>
        </div>
    </form>
    ```
- talk about `method` attribute
- GET vs. POST
- form needs `@csrf`

## Exercise 01

- fields not nullable, add them all in
- demo adding article content field

## Exercise 02

## Dealing with the post request (submitted data)
- new route:
    ```php
    Route::post('/animals/create', "Articles@createPost");
    ```
- note `post` part
- new Controller method structure:
    ```php
    public function createPost(Request $request)
    {
        
    }
    ```
- explore Laravel Request class, $request object, var_dump it
- full Controller method:
    ```php
    public function createPost(Request $request)
    {
        $data = $request->all();

        die(var_dump($data));

        Article::create($data);

        return redirect("/");
    }
    ```

## Exercise 03

## Demo removing die(var_dump($data));

## Mass Assignment Vulnerability
- add to model:
    `protected $fillable = ["title", "article"];`

## Exercise 04

## Validation
- Should always have server-side validation
- SQL:
    - non-null: `required`
    - `VARCHAR`: `max` length
    - type: `string`, `integer`, `date`
- General:
    - email
    - in database already: `exists:articles,title`
- Create a `FormRequest`: `artisan make:request ArticleRequest`
- Set `auth` to `true`
- Add `rules`
    ```php
    public function rules()
    {
        return [
            "title" => ["required", "string"],
            "article" => ["required", "string"],
        ];
    }
    ```
- Add `use App\Http\Requests\ArticleRequest`
- Inherits from `Request`, so has all same behaviours
- Update `Request` to `ArticleRequest`
- test submitting incorrect data

## Exercise 05

## Errors
- add class to field `@error('title') is-invalid @enderror`
- output error message:
    ```php
    @error('title')
        <p class="invalid-feedback">
            {{ $message }}
        </p>
    @enderror
    ```

## Exercise 06

- repopulating field with submitted content

{{ old("title") }}

## Exercise 07

## Exercise 08 - edit an animal (add form, route, controller etc.)

{{ old("title", $article ? $article->title : "") }}